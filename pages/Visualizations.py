import pandas as pd
import streamlit as st
import numpy as np
import datetime
import plotly.express as px
from urllib.request import urlopen
import json
from config import docket_data_link, docket_codebook_link, dtype_dict_dock, filter_dataframe, load_data

# create sections on page
header = st.container()
map_section = st.container()
line_section = st.container()
plot_section = st.container()


## header section
with header:
    st.title('Visualizations')

data = load_data(docket_data_link, 
                 state_name = 'df_dock', dtype_dict = dtype_dict_dock)

with map_section:
    st.subheader('Originating Tribunal Counts')

    ndala = ['01015', '01027', '01029', '01121', '01057', '01075', '01093', '01127', '01133', '01019', '01049', '01055', '01095', '01115',
            '01043', '01071', '01079', '01083', '01089', '01103', '01033', '01059', '01077', '01009', '01073', '01117',
            '01007', '01063', '01107', '01119', '01125']
    mdala = ['01017', '01081', '01087', '01111', '01113', '01123', '01001', '01005', '01011', '01013', '01021', '01037',
            '01039', '01041', '01051', '01085', '01101', '01109', '01031', '01045', '01061', '01067', '01069']
    sdala = ['01003', '01023', '01025', '01035', '01053', '01097', '01099', '01129',
            '01047', '01065', '01091', '01105', '01131']

    dalaska = ['02013','02016','02020','02050','02060','02063','02066','02068','02070','02090','02100','02105','02110','02122','02130',
            '02150','02158','02164','02170','02180','02185','02188','02195','02198','02220','02230','02240','02275','02282','02290']

    dariz = ['04001','04003','04005','04007','04009','04011','04012','04013','04015','04017','04019','04021','04023','04025', '04027']

    edark = ['05023', '05025', '05029', '05039', '05043', '05045', '05053', '05069', '05079', '05085', '05105', '05115', '05117', '05119',
            '05125', '05137', '05141', '05145', '05149', '05001', '05017', '05035', '05041', '05077', '05095', '05107', '05123',
            '05021', '05031', '05037', '05049', '05055', '05063', '05065', '05067', '05075', '05093', '05111', '05121', '05121', '05135', '05147']
    wdark = ['05003', '05011', '05013', '05027', '05027', '05103', '05139', '05007', '05087', '05143',
            '05033', '05047', '05071', '05083', '05113', '05127', '05131', '05005', '05009', '05015', '05089', '05101', '05129',
            '05019', '05051', '05059', '05097', '05109', '05057', '05061', '05073', '05081', '05091', '05099', '05133']

    cdcal = ['06065', '06071', '06059', '06037', '06079', '06083', '06111']
    edcal = ['06009', '06019', '06027', '06029', '06031', '06039', '06043', '06047', '06099', '06107', '06109',
            '06003', '06005', '06007', '06011', '06017', '06021', '06035', '06049', '06051', '06057', '06061', '06063', '06067', '06077', 
            '06089', '06091', '06093', '06095', '06101', '06103', '06105', '06113', '06115']
    ndcal = ['06001', '06013', '06015', '06023', '06033', '06041', '06045', '06053', '06055', '06069', '06075', '06081', '06085', '06087', '06097']
    sdcal = ['06025', '06073']

    dcolo = ['08001','08003','08005','08007','08009','08011','08013','08015','08017','08019','08021','08023','08025','08027',
            '08029','08031','08033','08035','08037','08039','08041','08043','08045','08047','08049','08051','08053','08055','08057',
            '08059','08061','08063','08065','08067','08069','08071','08073','08075','08077','08079','08081','08083','08085','08087','08089',
            '08091','08093','08095','08097','08099','08101','08103','08105','08107','08109','08111','08113','08115','08117','08119','08121',
            '08123','08125']

    dconn = ['09001','09003','09005','09007','09009','09011','09013','09015']

    ddel = ['10001', '10003', '10005']

    ddc = ['10001']

    ndfla = ['12001', '12029', '12041', '12067', '12075', '12005', '12013', '12045', '12059', '12063', '12133',
            '12033', '12091', '12113', '12131', '12037', '12039', '12065', '12073', '12077', '12079', '12123', '12129']

    mdfla = ['12015', '12021', '12027', '12043', '12051', '12071', '12003', '12007','12019', '12023', '12031', '12035', '12047', '12089',
            '12107', '12109', '12121', '12125', '12017', '12069', '12083', '12119',
            '12009', '12095', '12097', '12117', '12127', '12049', '12053', '12057', '12081', '12101','12103', '12105', '12115']
    sdfla = ['12011', '12055', '12061', '12085', '12025', '12087', '12093', '12099', '12111', '12086']

    ndga = ['13057', '13063', '13067', '13089', '13097', '13121', '13135', '13151', '13217', '13247',
            '13011', '13013', '13085', '13111', '13117', '13123', '13137', '13139', '13157', '13187', '13227', '13241', '13257', '13281', '13291', '13311',
        '13045', '13077', '13113', '13143', '13149', '13199', '13231', '13255', '13285',
        '13015', '13047', '13055', '13083', '13115', '13129', '13213', '13223', '13233', '13295', '13313']
    mdga = ['13007', '13017', '13037', '13081', '13087', '13095', '13099', '13131', '13177', '13201', '13205', '13249', '13253', '13261',
        '13273', '13287', '13307', '13321', '13059', '13105', '13119', '13133', '13147', '13195', '13211', '13219', '13221', '13297',
        '13053', '13061', '13145', '13197', '13215', '13239', '13243', '13259', '13263', '13269',
        '13009', '13021', '13023', '13035', '13079', '13093', '13141', '13153', '13159', '13169', '13171', '13193', '13207',
        '13225', '13235', '13237', '13289', '13293', '13303', '13315', '13319',
        '13019', '13027', '13065', '13071', '13075', '13101', '13155', '13173', '13185', '13275', '13277']
    sdga = ['13033', '13073', '13125', '13163', '13181', '13189', '13245', '13265', '13301', '13317',
        '13001', '13039', '13127', '13183', '13191', '13161', '13305',
        '13091', '13167', '13175', '13209', '13271', '13283', '13309', '13029', '13051', '13103', '13179',
        '13031', '13043', '13107', '13109', '13165', '13251', '13267', '13279',
        '13003', '13005', '13025', '13049', '13069', '13229', '13299']


    dhaw = ['15001', '15003', '15005', '15007', '15009']

    didaho = [ '16001','16003','16005','16007','16009','16011','16013','16015','16017','16019','16021','16023','16025','16027',
            '16029','16031','16033','16035','16037','16039','16041','16043','16045','16047','16049','16051','16053','16055','16057',
            '16059','16061','16063','16065','16067','16069','16071','16073','16075','16077','16079','16081','16083','16085','16087']

    ndill = ['17031', '17043', '17111', '17063', '17089', '17093', '17099', '17097', '17197',
            '17007', '17015', '17037', '17085', '17103', '17141', '17177', '17195', '17201']
    cdill = ['17001', '17009', '17011', '17017', '17019', '17021','17029', '17039', '17041', '17045', '17053', '17057', '17061', '17067', '17071', '17073',
            '17075', '17091', '17095', '17105', '17107', '17109', '17113', '17117', '17115', '17123', '17125', '17129', '17131', '17135', '17137',
            '17139', '17143', '17147', '17149', '17155', '17161', '17167', '17169', '17171', '17173', '17175', '17179', '17183', '17187', '17203']
    sdill = ['17003', '17005', '17013', '17023', '17025', '17027', '17033', '17035', '17047', '17049', '17051', '17055', '17059', '17065', '17069',
            '17077', '17079', '17081', '17083', '17087', '17101', '17119', '17127', '17121', '17133', '17145', '17151', '17153', '17157', '17159',
            '17165', '17163', '17181', '17185', '17189','17191', '17193', '17199']

    ndind = ['18001', '18003', '18009', '18033', '18053', '18069', '18075', '18087', '18113', '18151', '18179', '18183',
            '18089', '18127', '18007', '18015', '18073', '18111', '18157', '18171', '18181', '18017', '18039', '18049', '18085', '18091', '18099',
            '18103', '18131', '18141', '18149', '18169']
    sdind = ['18005', '18011', '18013', '18023', '18031', '18035', '18041', '18045', '18047', '18057', '18059', '18063', '18065', '18067', '18081',
            '18095', '18097', '18105', '18107', '18109', '18135', '18139', '18145', '18159', '18161', '18177',
            '18021', '18055', '18083', '18119', '18121', '18133', '18153', '18165', '18167',
            '18027', '18037', '18051', '18101', '18123', '18125', '18129', '18147', '18163', '18173',
            '18019', '18025', '18029', '18043', '18061', '18071', '18077', '18079', '18093', '18115', '18117', '18137', '18143', '18155', '18175']

    ndiowa = ['19011', '19031', '19075', '19083', '19095', '19105', '19113', '19171',
            '19023', '19025', '19027', '19033', '19063', '19069', '19079', '19081', '19091', '19109', '19147', '19151', '19187', '19189', '19195',
            '19197', '19005', '19013', '19017', '19019', '19037', '19043', '19055', '19061', '19065', '19067', '19089', '19097', '19131', '19191',
            '19021', '19035', '19041', '19047', '19059', '19093', '19119', '19133', '19141', '19143', '19149', '19161', '19167', '19193']
    sdiowa = ['19001', '19003', '19007', '19015', '19039', '19049', '19051', '19053', '19073', '19077', '19099', '19101', '19107', '19117', 
            '19121', '19123', '19125', '19127', '19135', '19153', '19157', '19159', '19169', '19173', '19175', '19179', '19181', '19185','19145',
            '19045', '19057', '19087', '19103', '19111', '19115', '19139', '19163', '19177', '19183',
            '19009', '19029', '19071', '19085', '19129', '19137', '1914', '19155', '19165', '19045']

    dkan = ['20000','20001','20003','20005','20007','20009','20011','20013','20015','20017','20019','20021','20023','20025','20027',
            '20029','20031','20033','20035','20037','20039','20041','20043','20045','20047','20049','20051','20053','20055','20057',
            '20059','20061','20063','20065','20067','20069','20071','20073','20075','20077','20079','20081','20083','20085','20087',
            '20089','20091','20093','20095','20097','20099','20101','20103','20105','20107','20109','20111','20113','20115','20117',
            '20119','20121','20123','20125','20127','20129','20131','20133','20135','20137','20139','20141','20143','20145','20147',
            '20149','20151','20153','20155','20157','20159','20161','20163','20165','20167','20169','20171','20173','20175','20177',
            '20179','20181','20183','20185','20187','20189','20191','20193','20195','20197','20199','20201','20203','20205','20207','20209']

    edky = ['21005', '21011', '21013', '21015', '21017', '21019', '21021', '21023', '21025', '21037', '21041', '21043', '21049', '21051',
        '21063', '21065', '21067', '21069', '21071', '21073', '21077', '21079', '21081', '21089', '21095', '21097', '21103',
        '21109', '21113', '21115', '21117', '21119', '21121', '21125', '21127', '21129', '21131', '21133', '21135', '21137',
        '21147', '21151', '21153', '21159', '21161', '21165', '21167', '21173', '21175', '21181', '21187', '21189', '21191', '21193', '21195',
        '21197', '21199', '21201', '21203', '21205', '21209', '21211', '21223', '21231', '21235', '21237', '21239']
    wdky = ['21001', '21003', '21007', '21009', '21027', '21029', '21031', '21033', '21035', '21039', '21045', '21047', '21053', '21055', '21057',
        '21059', '21061', '21075', '21083', '21085', '21087', '21091', '21093', '21099', '21101', '21105', '21107', '21111', '21123', '21139',
        '21141', '21143', '21155', '21157', '21145', '21149', '21163', '21169', '21171', '21177', '21179', '21183', '21185', '21207',
        '21213', '21215', '21217', '21219', '21221', '21225', '21227', '21229', '21233']

    edla = ['22007', '22051', '22057', '22071', '22075', '22087', '22089', '22093', '22095', '22103', '22105', '22109', '22117']
    mdla = ['22005', '22033', '22037', '22047', '22063', '22077', '22091', '22121', '22125']
    wdla = ['22001', '22003', '22009', '22011', '22013', '22015', '22017', '22019', '22021', '22023', '22025', '22027', '22029', '22031',
        '22035', '22039', '22041', '22043', '22045', '22049', '22053', '22055', '22059', '22061', '22065', '22067', '22069', '22073',
        '22079', '22081', '22083', '22085', '22097', '22099', '22101', '22107', '22111', '22113', '22115', '22119', '22123', '22127']

    dme = ['23001','23003','23005','23007','23009','23011','23013','23015','23017','23019','23021','23023','23025','23027','23029','23031']

    dmd = ['24001','24003','24005','24009','24011','24013','24015','24017','24019','24021','24023','24025','24027','24029','24031','24033',
        '24035','24037','24039','24041','24043','24045','24047','24510']

    dmass = ['25001','25003','25005','25007','25009','25011','25013','25015','25017','25019','25021','25023','25025','25027']

    edmich = ['26001', '26007', '26011', '26017', '26031', '26035', '26039', '26051', '26057', '26063', '26069', '26073', '26111', '26119',
            '26129', '26135', '26137', '26141', '26143', '26145', '26157', '26049', '26075', '26087', '26091', '26093',
            '26099', '26115', '26125', '26147', '26151', '26155', '26161', '26163']
    wdmich = ['26003', '26013', '26033', '26041', '26043', '26053', '26061', '26071', '26083', '26095', '26097', '26103', '26109',
            '26131', '26153',
            '26005', '26009', '26015', '26019', '26021', '26023', '26025', '26027', '26029', '26037', '26045', '26047', '26055', '26059','26065',
            '26067', '26077', '26079', '26081', '26085', '26089', '26101', '26105', '26107', '26113', '26117', '26121', '26123', '26127', '26133', '26139',
            '26149', '26159', '26165', '26015']

    dminn = ['27001','27003','27005','27007','27009','27011','27013','27015','27017','27019','27021','27023','27025','27027','27029',
            '27031','27033','27035','27037','27039','27041','27043','27045','27047','27049','27051','27053','27055','27057','27059',
            '27061','27063','27065','27067','27069','27071','27073','27075','27077','27079','27081','27083','27085','27087','27089',
            '27091','27093','27095','27097','27099','27101','27103','27105','27107','27109','27111','27113','27115','27117','27119',
            '27121','27123','27125','27127','27129','27131','27133','27135','27137','27139','27141','27143','27145','27147','27149',
            '27151','27153','27155','27157','27159','27161','27163','27165','27167','27169','27171','27173']

    ndmiss = ['28003', '28017', '28019', '28025', '28057', '28081', '28087', '28095', '28105', '28117', '28141', '28155', '28159',
            '28009', '28013', '28033', '28071', '28093', '28107', '28115', '28119', '28135', '28137', '28139', '28143', '28145', '28161',
            '28007', '28011', '28015', '28027', '28043', '28053', '28083', '28097', '28133', '28151']
    sdmiss = ['28001', '28005', '28021', '28023', '28029', '28031', '28035', '28037', '28039', '28041', '28048', '28047', '28049', '28051',
            '28055', '28059', '28061', '28063', '28065', '28067', '28069', '28073', '28075', '28077', '28079', '28085', '28089', '28091',
            '28099', '28101', '28103', '28109', '28111', '28113', '28121', '28123', '28125', '28127', '28129', '28131', '28147', '28149',
            '28153', '28157', '28163']

    edmo = ['29055', '29065', '29071', '29073', '29099', '29113', '29125', '29161', '29183', '29187', '29189', '29219', '29221', '29510',
        '29001', '29007', '29041', '29045', '29103', '29111', '29115', '29121', '29127', '29137', '29139', '29163', '29173', '29175',
        '29197', '29205', '29199',
            '29017', '29023', '29031', '29035', '29069', '29093', '29123', '29133', '29143', '29155', '29157', '29179', '29181', '29186', '29201',
            '29203', '29207', '29223']
    wdmo = ['29013', '29033', '29037', '29047', '29083', '29095', '29101', '29107', '29177', '29185', '29195',
        '29015', '29019', '29027', '29029', '29051', '29053', '29085', '29089', '29131', '29135', '29141', '29151', '29159',
        '29039', '29043', '29057', '29059', '29067', '29077', '29091', '29105', '29149', '29153', '29167', '29169', '29213', '29215', '29225', '29229',
        '29003', '29005', '29021', '29025', '29049', '29061', '29063', '29075', '29079', '29081', '29087', '29117', '29129', '29147', '29165', '29171', '29211', '29227',
        '29009', '29011', '29097', '29109', '29119', '29145', '29209', '29217']

    dmont = ['30001','30003','30005','30007','30009','30011','30013','30015','30017','30019','30021','30023','30025','30027','30029',
            '30031','30033','30035','30037','30039','30041','30043','30045','30047','30049','30051','30053','30055','30057','30059',
            '30061','30063','30065','30067','30069','30071','30073','30075','30077','30079','30081','30083','30085','30087','30089',
            '30091','30093','30095','30097','30099','30101','30103','30105','30107','30109','30111','30113']

    dneb = ['31001','31003','31005','31007','31009','31011','31013','31015','31017','31019','31021','31023','31025','31027','31029',
            '31031','31033','31035','31037','31039','31041','31043','31045','31047','31049','31051','31053','31055','31057','31059',
            '31061','31063','31065','31067','31069','31071','31073','31075','31077','31079','31081','31083','31085','31087','31089',
            '31091','31093','31095','31097','31099','31101','31103','31105','31107','31109','31111','31113','31115','31117','31119',
            '31121','31123','31125','31127','31129','31131','31133','31135','31137','31139','31141','31143','31145','31147','31149',
            '31151','31153','31155','31157','31159','31161','31163','31165','31167','31169','31171','31173','31175','31177','31179',
            '31181','31183','31185']

    dnev = ['32001','32003','32005','32007','32009','32011','32013','32015','32017','32019','32021','32023','32027','32029','32031',
            '32033','32510']
            
    dnh = ['33000','33001','33003','33005','33007','33009','33011','33013','33015','33017','33019']        
            
    dnj = ['34000','34001','34003','34005','34007','34009','34011','34013','34015','34017','34019','34021','34023','34025','34027','34029','34031',
            '34033','34035','34037','34039','34041']
            
    dnm = ['35001','35003','35005','35006','35007','35009','35011','35013','35015','35017','35019','35021','35023','35025','35027',
        '35028','35029','35031','35033','35035','35037','35039','35041','35043','35045','35047','35049','35051','35053','35055',
        '35057','35059','35061']       

    edny =['36059','36103','36047','36081','36085']
    ndny = ['36001','36007','36011','36017','36019','36021','36023','36025','36031','36033','36035','36039','36041','36043','36045',
            '36049','36053','36057''36065','36067','36075','36077','36083','36091','36093','36095','36089','36107','36109','36111','36113','36115']
    sdny = ['36005','36061','36119','36079','36087','36027','36071','36105']
    wdny = ['36003','36009','36013','36015','36029','36037','36051','36055','36063','36069','36073','36097','36099','36101','36117','36121','36123']

    ednc = ['37013','37031','37049','37065','37079','37083','37095','37103','37107','37117','37137','37147','37017','37019',
            '37047','37061','37129','37133','37141','37155','37163','37051','37069','37077','37085','37101','37127','37181',
            '37183','37185','37191','37195','37015','37029''37041','37053','37055','37073','37091','37131','37139','37143','37177','37187']
    mdnc = ['37001','37025','37033','37037','37057','37059','37063','37067','37081','37093','37105','37123','37125','37135','37145','37151',
            '37153','37157','37159','37165','37167','37169','37171','37197']
    wdnc = ['37003','37005','37007','37009','37011','37021','37023','37027','37035','37039','37043','37045','37071','37075','37087','37089',
            '37097','37099','37109','37111','37113','37115','37119','37121','37149','37161','37173','37175','37179','37189','37193','37199']

    dnd = ['38001','38003','38005','38007','38009','38011','38013','38015','38017','38019','38021','38023','38025','38027','38029','38031',
        '38033','38035','38037','38039','38041','38043','38045','38047','38049','38051','38053','38055','38057','38059','38061','38063',
        '38065','38067','38069','38071','38073','38075','38077','38079','38081','38083','38085','38087','38089','38091','38093','38095',
        '38097','38099','38101','38103','38105']

    ndohio = ['39005','39007','39019','39029','39033','39035','39055','39075','39085','39093','39099','39103','39133','39139','39151','39153',
            '39155','39157','39169','39003','39011','39039','39043','39051','39063','39069','39077','39095','39101','39107','39123','39125',
            '39137','39143','39147','39161','39171','39173','39175']

    sdohio = ['39001','39009','39013','39015','39017','39021','39023','39025','39027','39031','39037','39041','39045','39047','39049','39053',
            '39057','39059','39061','39065','39067','39071','39073','39079','39081','39083','39087','39089','39091','39097','39105','39109',
            '39111','39113','39115','39117','39119','39121','39127','39129','39131','39135','39141','39145','39149','39159','39163','39165','39167']

    edok = ['40001','40005','40013','40019','40021','40023','40029','40061','40063','40069','40077','40079','40085','40095','40089','40091',
            '40099','40101',   '40107','40111','40121','40123','40127','40133','40135','40145']
    ndok = ['40035','40037','40041','40097','40105','40113','40115','40117','40131','40143','40147']
    wdok = ['40003','40007','40009','40011','40015','40017','40025','40027','40031','40033','40039','40043','40045','40047','40049','40051',
            '40053','40055','40057','40059','40065','40067','40071','40073','40075','40081','40083','40087','40093','40103','40109','40119',
            '40125','40129','40137','40139','40141','40149','40151','40153']

    dore = ['41001','41003','41005','41007','41009','41011','41013','41015','41017','41019','41021','41023','41025','41027','41029','41031',
            '41033','41035','41037','41039','41041','41043','41045','41047','41049','41051','41053','41055','41057','41059','41061','41063',
            '41065','41067','41069','41071']

    edpa = ['42101','42011','42017','42029','42045','42071','42077','42091','42095']
    wdpa = ['42039','42047','42049','42053','42083','42121','42123','42009','42013','42021','42033','42111','42003','42005','42007','42019',
            '42031','42051','42059','42063','42065', '42073','42085','42125','42129']
    mdpa = ['42001','42015','42023','42025','42027','42035','42037','42041','42043','42055','42057','42061','42067','42069','42075','42079',
            '42081','42087','42089','42093','42097','42099','42103','42105','42107','42109','42113','42115','42117','42119','42127','42131','42133']

    dri = ['44001', '44003', '44005', '44007', '44009']

    dsc = ['45001','45003','45005','45007','45009','45011','45013','45015','45017','45019','45021','45023','45025','45027','45029','45031','45033',
        '45035','45037','45039','45041','45043','45045','45047','45049','45051','45053','45055','45057','45059','45061','45063','45065','45067',
        '45069','45071','45073','45075','45077','45079','45081','45083','45085','45087','45089','45091']

    dsd = ['46000','46003','46005','46007','46009','46011','46013','46015','46017','46019','46021','46023','46025','46027','46029','46031',
        '46033','46035','46037','46039','46041','46043','46045','46047','46049','46051','46053','46055','46057','46059','46061','46063',
        '46065','46067','46069','46071','46073','46075','46077','46079','46081','46083','46085','46087','46089','46091','46093','46095',
        '46097','46099','46101','46103','46105','46107','46109','46111','46113','46115','46117','46119','46121','46123','46125','46127',
        '46129','46135','46137']

    wdtenn = ['47005','47017','47023','47033','47039','47045','47047','47053','47069','47071','47075','47077','47079','47095','47097','47113',
            '47109','47131','47135','47157','47167','47183']

    mdtenn = ['47055','47081','47099','47101','47117','47119','47181','47027','47035','47041','47049','47087','47111','47133','47137','47141',
            '47159','47185','47015','47021','47037','47043','47083','47085','47125','47147','47149','47161','47165','47169','47187','47189']

    edtenn = ['47001','47003','47007','47009','47011','47013','47019','47025','47029','47031','47051','47057','47059','47061','47063','47065',
            '47067','47073','47089','47091','47093','47103','47105','47107','47115','47121','47123','47127','47129','47139','47143','47145',
            '47151','47153','47155','47163','47171','47173','47175','47177','47179']


    edtex = ['48199','48241','48245','48291','48351','48361','48005','48225','48347','48373','48403','48405','48419','48455','48457', '48063',
            '48067','48203','48315','48343','48459','48085','48097','48119','48121','48147','48181','48223','48277','48037','48159','48387',
            '48449','48001','48073','48183','48213','48365','48379','48401','48423','48467','48499']
    sdtex = ['48061','48489','48007','48025','48047','48131','48249','48261','48273','48297','48355','48409','48039','48071','48167','48321',
            '48015','48041','48089','48149','48157','48185','48201','48313','48339','48407','48471','48473','48481','48247','48283','48311',
            '48479','48505','48215','48427','48057','48123','48175','48239','48285','48391','48469']
    wdtex = ['48021','48031','48051','48053','48055','48171','48209','48267','48281','48287','48299','48307','48319','48411','48453','48477',
            '48491','48137','48271','48323','48443','48463','48465','48507','48141','48229','48003','48103','48135','48317','48329','48461',
            '48043','48109','48243','48301','48371','48377','48389','48475','48495','48013','48019','48029','48091','48127','48163','48177',
            '48187','48255','48259','48265','48325','48385','48493','48027','48035','48099','48145','48161','48193','48217','48289','48293',
            '48309','48331','48395','48425']

    ndtex = ['48009','48011','48017','48023','48033','48045','48049','48059','48065','48069','48075','48077','48079','48081','48083','48087',
            '48093','48095','48101','48105','48107','48111','48113','48115','48117','48125','48129','48133','48139','48143','48151','48153',
            '48155','48165','48169','48173','48179','48189','48191','48195','48197','48205','48207','48211','48219','48221','48227','48231',
            '48233','48235','48237','48251','48253','48257','48263','48269','48275','48279','48295','48303','48305','48327','48333','48335',
            '48337','48341','48345','48349','48353','48357','48359','48363','48367','48369','48375','48381','48383','48393','48397','48399',
            '48413','48415','48417','48421','48429','48431','48433','48435','48437','48439','48441','48445','48447','48451','48483','48485',
            '48487','48497','48501','48503']

    dutah = ['49001','49003','49005','49007', '49009','49011','49013','49015','49017','49019','49021','49023','49025','49027','49029','49031',
            '49033','49035','49037','49039','49041','49043','49045','49047','49049','49051','49053','49055','49057']

    dvt = ['50001','50003','50005','50007','50009','50011','50013','50015','50017','50019','50021','50023','50025','50027']

    wdva = ['51003','51005','51009','51011','51015','51017','51019','51021','51023','51027','51029','51031','51035','51037','51043','51045',
            '51047','51049','51051','51063','51065','51067','51069','51071','51077','51079','51083','51089','51091','51105','51109','51113',
            '51121','51125','51137','51139','51141','51143','51155','51157','51161','51163','51165','51167','51169','51171','51173','51185',
            '51187','51191','51195','51197','51510','51515','51520','51530','51540','51580','51590','51640','51660','51678','51680','51690',
            '51720','51750','51770','51775','51790','51820','51840']

    edva = ['51001','51007','51013','51025','51033','51036','51041','51053','51057','51059','51061','51073','51075','51081','51085','51087',
            '51093','51095','51097','51099','51101','51103','51107','51111','51115','51117','51119','51127','51131','51133','51135','51145',
            '51147','51149','51153','51159','51175','51177','51179','51181','51183','51193','51199','51550','51560','51570','51595','51600',
            '51610','51620','51630','51650','51670','51683','51685','51700','51710','51730','51735','51740','51760','51780','51800','51810','51830']

    edwash = ['53001','53003','53005','53007','53013','53017','53019','53021','53023','53025','53037','53039','53043','53047','53051','53063',
            '53065','53071','53075','53077']
    wdwash = ['53009','53011','53015','53027','53029','53031','53033','53035','53041','53045','53049','53053','53055','53057','53059','53061',
            '53067','53069','53073']

    sdwva = ['54025','54081','54089','54109','54055','54047','54063','54005','54015','54019','54035','54039','54043','54045','54059','54067',
            '54087','54105','54107','54011','54053','54079','54099']
    ndwva = ['54001','54003','54007','54009','54013','54017','54021','54023','54027','54029','54031','54033','54037','54041','54049','54051',
            '54057','54061','54065','54069','54071','54073','54075','54077','54083','54085','54091','54093','54095','54097','54101','54103']

    wdwis = ['55001','55003','55005','55007','55011','55013','55017','55019','55021','55023','55025','55031','55033','55035','55043','55045',
            '55049','55051','55053','55055','55057','55063','55065','55069','55073','55081','55085','55091','55093','55095','55097','55099',
            '55103','55105','55107','55109','55111','55113','55119','55121','55123','55125','55129','55141']
    edwis = ['55009','55015','55027','55029','55037','55039','55041','55047','55059','55061','55067','55071','55075','55077','55078','55079',
            '55083','55087','55089','55101','55115','55117','55127','55131','55133','55135','55137','55139']

    dwyo = ['56001','56003','56005','56007','56009','56011','56013','56015','56017','56019','56021','56023','56025','56027','56029','56031','56033','56035','56037','56039','56041','56043','56045']


    us_plot_df = data.groupby(['TribOfOrigin']).count().reset_index()
    #us_plot_df['CourtOrigin'] = us_plot_df['TribOfOrigin'].str.replace(r'[^\w\s]+', '').str.lower()
    us_plot_df['CourtOrigin'] = us_plot_df['TribOfOrigin'].str.replace('.','')
    us_plot_df['CourtOrigin'] = us_plot_df['CourtOrigin'].str.lower()
    us_districts = ['ndala', 'mdala', 'sdala', 'dalaska', 'dariz', 'edark', 'wdark', 'cdcal', 'edcal', 'ndcal', 'sdcal', 'dcolo', 'dconn', 'ddel', 'ddc', 'ndfla', 'mdfla', 'sdfla', 'ndga', 'mdga', 'sdga', 'dhaw', 'didaho','ndill', 'cdill', 'sdill', 'ndind', 'sdind', 'ndiowa', 'sdiowa', 'dkan', 'edky', 'wdky',
                    'edla', 'mdla', 'wdla', 'dme', 'dmd', 'dmass', 'edmich', 'wdmich', 'dminn', 'ndmiss', 'sdmiss', 'edmo', 'wdmo', 'dmont', 'dneb', 'dnev', 'dnh', 'dnj', 'dnm', 'edny', 'ndny', 'sdny', 'wdny', 'ednc', 'mdnc', 'wdnc', 'dnd', 'ndohio', 'sdohio', 'edok', 'ndok', 'wdok', 'dore', 'edpa', 'wdpa', 'mdpa', 'dri', 'dsc',
                    'dsd', 'wdtenn', 'mdtenn', 'edtenn', 'edtex', 'sdtex', 'wdtex', 'ndtex', 'dutah', 'dvt', 'wdva', 'edva', 'edwash', 'wdwash', 'sdwva', 'ndwva', 'wdwis', 'edwis', 'dwyo']
    district_list = (ndala+mdala+sdala+dalaska+dariz+edark+wdark+cdcal+edcal+ndcal+sdcal+dcolo+dconn+ddel+ddc+ndfla+mdfla+sdfla+ndga+mdga+sdga+dhaw+didaho+ndill+cdill+sdill+ndind+sdind+ndiowa+sdiowa+dkan+edky+wdky+edla+mdla+wdla+dme+dmd+dmass+edmich+wdmich+dminn+
        ndmiss+sdmiss+edmo+wdmo+dmont+dneb+dnev+dnh+dnj+dnm+edny+ndny+sdny+wdny+ednc+mdnc+wdnc+dnd+ndohio+sdohio+edok+ndok+wdok+dore+edpa+wdpa+mdpa+dri+dsc+dsd+wdtenn+mdtenn+edtenn+edtex+sdtex+wdtex+ndtex+dutah+dvt+wdva+edva+edwash+wdwash+
        sdwva+ndwva+wdwis+edwis+dwyo)
    us_fips = [ndala, mdala, sdala, dalaska, dariz, edark, wdark, cdcal, edcal, ndcal, sdcal, dcolo, dconn, ddel, ddc, ndfla, mdfla, sdfla, ndga, mdga, sdga, dhaw, didaho,ndill, cdill, sdill, ndind, sdind, ndiowa, sdiowa, dkan, edky, wdky, edla, mdla, wdla, dme, dmd, dmass, edmich, wdmich, 
            dminn, ndmiss, sdmiss, edmo, wdmo, dmont, dneb, dnev, dnh, dnj, dnm, edny, ndny, sdny, wdny, ednc, mdnc, wdnc, dnd, ndohio, sdohio, edok, ndok, wdok, dore, edpa, wdpa, mdpa, dri, dsc, dsd, wdtenn, mdtenn, edtenn, edtex, sdtex, wdtex, ndtex, dutah, dvt, wdva, edva, edwash, wdwash, sdwva, ndwva, wdwis, edwis, dwyo]

    count_fips = []
    for i in range(0, len(us_districts)):
        if us_districts[i] in list(us_plot_df['CourtOrigin']):
            count_fips.append(np.full(len(us_fips[i]),(us_plot_df.loc[us_plot_df['CourtOrigin'] == us_districts[i]]['PACER_ID'].values[0]))) 
        else:
            count_fips.append(np.zeros(len(us_fips[i])))
        
    fip_df = pd.DataFrame(data = {'fips': district_list, 'count': np.hstack(count_fips)})


    with urlopen('https://raw.githubusercontent.com/plotly/datasets/master/geojson-counties-fips.json') as response:
        counties = json.load(response)

    fig = px.choropleth(fip_df, geojson=counties, locations='fips', color='count',
                            color_continuous_scale="plasma",
                            range_color=(0, 60),
                            scope="usa",
                            labels={'count':'Number of Cases'}
                            )
    fig.update_layout(margin={"r":0,"t":0,"l":0,"b":0})
    #fig.show()
    st.plotly_chart(fig)

with line_section:
    st.subheader('Federal Court Dispositions')
    document_data_link = 'https://raw.githubusercontent.com/sdannels/Federal_Circuit_Decisions_Beta/main/Data/appeals%202022-12-31%20Release.tab'

    dtype_dict = {'uniqueID': str, 'docYear': int, 'origin': 'category',
              'docType': 'category', 'DisputeType': 'category', 
              'Dispute_General': 'category', 'utilityPatent': 'category', 
              'designPatent': 'category', 'plantPatent': 'category',
              'designPatent_old': 'category', 'Appellant_Type_Primary': 'category',
              'Dissent': 'category', 'Concurrence': 'category'}
    df1 = load_data(document_data_link, state_name = 'data', dtype_dict = dtype_dict)
    df8 = df1.groupby(['docYear','DispGeneral']).count().reset_index()
    df8 = df8.rename(columns = {'uniqueID': 'Count'})
    fig8 = px.bar(df8, x = 'docYear', y = 'Count', color = 'DispGeneral', title = 'Dispositions')
    st.plotly_chart(fig8)


with plot_section:
    st.subheader('Filter Results by Year')
    

    start_date = st.date_input('Start Date', datetime.date(2004,10,1), min_value = datetime.date(2004,10,1), max_value = datetime.date.today() - datetime.timedelta(days=1) )
    end_date = st.date_input('End Date', datetime.date.today(), min_value = datetime.date(2004,10,2), max_value = datetime.date.today() )
    if start_date < end_date:
        st.success('Start date: `%s`\n\nEnd date:`%s`' % (start_date, end_date))
    else:
        st.error('Error: End date must fall after start date.')
    df1['docDate'] = pd.to_datetime(df1['docDate']).dt.date

    df_year_filter = df1[(df1['docDate'] > start_date) & (df1['docDate'] < end_date)]
    origin_df = df_year_filter.groupby('origin').count()
    fig_o = px.bar(origin_df.reset_index(), x = 'origin', y = 'uniqueID', title = 'Court Origins')
    st.plotly_chart(fig_o)
    
    
    yearXorigin_df = df_year_filter.groupby(['docYear','origin']).count()
    yearXorigin_df = yearXorigin_df.rename(columns = {'uniqueID': 'Count'})
    fig_yearo = px.bar(yearXorigin_df.reset_index(), x = 'docYear', y = 'Count', color = 'origin', title = 'Court Origins over Time')
    st.plotly_chart(fig_yearo)

    prec = df_year_filter.loc[df_year_filter['PrecedentialStatus'] == 'Precedential']
    prec_gp = prec.groupby(['DispGeneral']).count().reset_index()
    prec_gp = prec_gp.rename(columns = {'uniqueID': 'Count'})
    fig_prec = px.pie(prec_gp, values = 'Count', names = 'DispGeneral',title = 'Precedential Case Results')
    st.plotly_chart(fig_prec)

    no_prec = df_year_filter.loc[df_year_filter['PrecedentialStatus'] != 'Precedential']
    no_prec_gp = no_prec.groupby(['DispGeneral']).count().reset_index()
    no_prec_gp = no_prec_gp.rename(columns = {'uniqueID': 'Count'})
    no_fig_prec = px.pie(no_prec_gp, values = 'Count', names = 'DispGeneral',title = 'Non-Precedential Case Results')
    st.plotly_chart(no_fig_prec)